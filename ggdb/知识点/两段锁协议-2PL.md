## 前置知识
### 共享锁（Share Lock）
**共享锁又称读锁，是读取操作创建的锁**。其他用户可以并发读取数据，但任何事务都不能对数据进行修改（获取数据上的排他锁），直到释放所有的共享锁。
如果事务T对数据A加上共享锁后，则其他事务只能对A再加共享锁，不能加排他锁。获准共享锁的事务只能读数据，不能修改数据。
### 排他锁（eXclusive Lock）
**排他锁又称写锁**，如果事务T对数据A加上排他锁后，则其他事务不能再对A加任任何类型的封锁。获准排他锁的事务既能读数据，又能修改数据。
### 并发操作会导致什么？
并发操作可能会导致丢失修改问题，一操作被另外一操作所覆盖，原因是并发操作破坏了事务的隔离性。
这个时候需要引用两段锁协议，避免产生数据不一致的问题。
## 为什么需要两阶段加锁?
引入`**2PL(Two-phase locking)**`是为了保证事务的隔离性，即多个事务在并发的情况下等同于串行的执行。
在实际情况下，SQL是千变万化、条数不定的,数据库很难在事务中判定什么是加锁阶段，什么是解锁阶段。于是引入了`**S2PL(Strict-2PL)**`即:
在事务中只有提交(commit)或者回滚(rollback)时才是解锁阶段， 其余时间为加锁阶段。
概念:

- 2PL,两阶段加锁协议:主要用于单机事务中的一致性与隔离性。
- 2PC,两阶段提交协议:主要用于分布式事务。
### 含义
在MySQL中，两阶段锁协议的含义是：当一个事务获取到了某一个数据库对象的锁之后，并不是当前事务不需要操作它了之后，这个说就会马上释放掉，这个锁会一直被这个事务持有，直到这个事务被提交或回滚后，这个锁才会被释放掉。所以，在当前事务还没有结束的时候，任何其他事务尝试获取这个锁的时候，都会被阻塞。知道当前事务提交或回滚后，前提事务才可以获取到这把锁。
这就是MySQL中2PL两阶段锁协议的含义。它在事务并发的时候，为数据的一致性提供有力的保障。
> 转载：[https://www.cnblogs.com/origin-zy/p/17395701.html](https://www.cnblogs.com/origin-zy/p/17395701.html)

